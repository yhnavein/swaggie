version: 2
jobs:
  build:
    docker:
      - image: circleci/node:16
    working_directory: ~/repo

    steps:
      - checkout
      - run: yarn install
      - run: yarn build
      - run: yarn test

  swashbuckle:
    docker:
      - image: mcr.microsoft.com/dotnet/sdk:5.0
    working_directory: ~/repo

    steps:
      - checkout
      - run: |
          cd samples/dotnetcore/swashbuckle/Swaggie.Swashbuckle
          dotnet tool install Swashbuckle.AspNetCore.Cli
          dotnet restore Swaggie.Swashbuckle.sln
          dotnet build Swaggie.Swashbuckle.sln

  nswag:
    docker:
      - image: mcr.microsoft.com/dotnet/sdk:5.0
    working_directory: ~/repo

    steps:
      - checkout
      - run: |
          cd samples/dotnetcore/nswag/Swaggie.Nswag
          dotnet restore Swaggie.Nswag.sln
          dotnet build Swaggie.Nswag.sln

workflows:
  version: 2
  build_all:
    jobs:
      - build
      - swashbuckle
      - nswag
